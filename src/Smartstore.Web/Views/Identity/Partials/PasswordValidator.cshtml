@using Smartstore.Web.Models.Identity

@inject CustomerSettings CustomerSettings

@{
    var res = new Dictionary<string, string>
    {
        ["TooShort"] = T("Identity.Error.PasswordTooShort", CustomerSettings.PasswordMinLength),
        ["RequiresLower"] = T("Identity.Error.PasswordRequiresLower"),
        ["RequiresUpper"] = T("Identity.Error.PasswordRequiresUpper"),
        ["RequiresDigit"] = T("Identity.Error.PasswordRequiresDigit"),
        ["RequiresNonAlphanumeric"] = T("Identity.Error.PasswordRequiresNonAlphanumeric"),
        ["RequiresUniqueChars"] = T("Identity.Error.PasswordRequiresUniqueChars", CustomerSettings.PasswordRequiredUniqueChars)
    };
}

<script sm-target-zone="scripts" data-origin="password-validator" type="module">
    import { PasswordValidator } from "@(Url.Content("~/js/smartstore.passwordvalidator.js"))";

    const validator = new PasswordValidator({
            minLength: @(CustomerSettings.PasswordMinLength),
            requireLowercase: @(CustomerSettings.PasswordRequireLowercase.ToString().ToLower()),
            requireUppercase: @(CustomerSettings.PasswordRequireUppercase.ToString().ToLower()),
            requireDigit: @(CustomerSettings.PasswordRequireDigit.ToString().ToLower()),
            requireNonAlphanumeric: @(CustomerSettings.PasswordRequireNonAlphanumeric.ToString().ToLower()),
            requiredUniqueChars: @(CustomerSettings.PasswordRequiredUniqueChars)
        }, {
        @foreach (var (key, val) in res)
        {
            <text>"@key": "@val",</text>
        }
    });
</script>
